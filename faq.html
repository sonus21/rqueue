<!DOCTYPE html>
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<link rel="stylesheet" href="/rqueue/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-HWK3PKDELN"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-HWK3PKDELN', { 'anonymize_ip': true }); </script> <script src="/rqueue/assets/js/vendor/lunr.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script src="/rqueue/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="/rqueue/static/favicon/favicon.ico" type="image/x-icon">
<title>FAQ | Rqueue</title>
<meta name="generator" content="Jekyll v4.3.2">
<meta property="og:title" content="FAQ">
<meta property="og:locale" content="en_US">
<meta name="description" content="Frequently Asked Questions about Rqueue">
<meta property="og:description" content="Frequently Asked Questions about Rqueue">
<link rel="canonical" href="https://sonus21.github.io/rqueue/rqueue/faq">
<meta property="og:url" content="https://sonus21.github.io/rqueue/rqueue/faq">
<meta property="og:site_name" content="Rqueue">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="FAQ"> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Frequently Asked Questions about Rqueue","headline":"FAQ","url":"https://sonus21.github.io/rqueue/rqueue/faq"}</script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9220054661402722" crossorigin="anonymous"></script>
</head>
<body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewbox="0 0 24 24"><title>Link</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewbox="0 0 24 24"><title>Menu</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewbox="0 0 24 24"><title>Expand</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title>
<path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewbox="0 0 24 24"><title>Document</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewbox="0 0 24 24"><title>Search</title>
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewbox="0 0 16 16"><title>Copy</title>
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewbox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"></path><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"></path> </svg> </symbol> <symbol id="svg-copied" viewbox="0 0 16 16"><title>Copied</title>
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewbox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"></path><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"></path> </svg> </symbol> </svg><div class="side-bar">
<div class="site-header"> <a href="/rqueue/" class="site-title lh-tight"> Rqueue </a> <a href="#" id="menu-button" class="site-button"> <svg viewbox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a>
</div>
<nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list">
<li class="nav-list-item"><a href="/rqueue/" class="nav-list-link">Home</a></li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander" aria-label="toggle links in Configuration category"> <svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/rqueue/configuration" class="nav-list-link">Configuration</a><ul class="nav-list">
<li class="nav-list-item "><a href="/rqueue/configuration/redis-configuration/" class="nav-list-link">Redis Configuration</a></li>
<li class="nav-list-item "><a href="/rqueue/configuration/retry-and-backoff/" class="nav-list-link">Retry and Backoff</a></li>
</ul>
</li>
<li class="nav-list-item">
<a href="#" class="nav-list-expander" aria-label="toggle links in Producer Consumer category"> <svg viewbox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/rqueue/producer-consumer" class="nav-list-link">Producer Consumer</a><ul class="nav-list">
<li class="nav-list-item "><a href="/rqueue/message-handling" class="nav-list-link">Message Handling</a></li>
<li class="nav-list-item "><a href="/rqueue/message-deduplication" class="nav-list-link">Message Deduplication</a></li>
<li class="nav-list-item "><a href="/rqueue/middleware" class="nav-list-link">Middleware</a></li>
<li class="nav-list-item "><a href="/rqueue/priority" class="nav-list-link">Queue Priority</a></li>
</ul>
</li>
<li class="nav-list-item"><a href="/rqueue/callback-and-events" class="nav-list-link">Callbacks and Events</a></li>
<li class="nav-list-item"><a href="/rqueue/dashboard" class="nav-list-link">Rqueue Dashboard</a></li>
<li class="nav-list-item"><a href="/rqueue/monitoring-alerting" class="nav-list-link">Monitoring and Alerting</a></li>
<li class="nav-list-item active"><a href="/rqueue/faq" class="nav-list-link active">FAQ</a></li>
<li class="nav-list-item"><a href="/rqueue/CHANGELOG/" class="nav-list-link">CHANGELOG</a></li>
<li class="nav-list-item"><a href="/rqueue/migration" class="nav-list-link">Migration from older to new version</a></li>
</ul>
<ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/sonus21/rqueue" class="nav-list-link external"> Rqueue on GitHub <svg viewbox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a>
</li></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer>
</div>
<div class="main" id="top">
<div id="main-header" class="main-header">
<div class="search">
<div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Rqueue" aria-label="Search Rqueue" autocomplete="off"> <label for="search-input" class="search-label"><svg viewbox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
</div>
<div id="search-results" class="search-results"></div>
</div>
<nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/sonus21/rqueue" class="site-button"> Rqueue on GitHub </a>
</li></ul></nav>
</div>
<div id="main-content-wrap" class="main-content-wrap"><div id="main-content" class="main-content" role="main">
<h2 id="how-can-we-handle-different-types-of-messages-with-a-single-listener"> <a href="#how-can-we-handle-different-types-of-messages-with-a-single-listener" class="anchor-heading" aria-labelledby="how-can-we-handle-different-types-of-messages-with-a-single-listener"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How can we handle different types of messages with a single listener?</h2>
<p>Sometimes, you may need a single message listener to handle various asynchronous tasks. To achieve this, define a superclass and subclasses for different message types. In your listener, enqueue instances of these subclasses using the superclass.</p>
<p><strong>Define Message Classes</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">FancyMessage</span> <span class="o">{</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">SuperFancyMessage</span> <span class="kd">extends</span> <span class="nc">FancyMessage</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">fancy</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">OkOkFancyMessage</span> <span class="kd">extends</span> <span class="nc">FancyMessage</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">okOk</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Here, <code class="language-plaintext highlighter-rouge">FancyMessage</code> acts as a superclass for <code class="language-plaintext highlighter-rouge">SuperFancyMessage</code> and <code class="language-plaintext highlighter-rouge">OkOkFancyMessage</code>. You can enqueue both <code class="language-plaintext highlighter-rouge">SuperFancyMessage</code> and <code class="language-plaintext highlighter-rouge">OkOkFancyMessage</code> instances in the same queue.</p>
<p><strong>Enqueuing Process</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">MyMessageEnqueuer</span> <span class="o">{</span>

  <span class="nd">@Autowired</span>
  <span class="kd">private</span> <span class="nc">RqueueMessageEnqueuer</span> <span class="n">rqueueMessageEnqueuer</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">enqueueFancyMessage</span><span class="o">(</span><span class="nc">FancyMessage</span> <span class="n">fancyMessage</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">rqueueMessageEnqueuer</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="s">"fancy-queue"</span><span class="o">,</span> <span class="n">fancyMessage</span><span class="o">);</span>
    <span class="c1">// handle errors</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p><strong>Message Listener</strong></p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">FancyMessageListener</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleSuperFancyMessage</span><span class="o">(</span><span class="nc">SuperFancyMessage</span> <span class="n">superFancyMessage</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// handle SuperFancyMessage</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">handleOkOkFancyMessage</span><span class="o">(</span><span class="nc">OkOkFancyMessage</span> <span class="n">okOkFancyMessage</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// handle OkOkFancyMessage</span>
  <span class="o">}</span>

  <span class="nd">@RqueueListener</span><span class="o">(</span><span class="s">"fancy-queue"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="nc">FancyMessage</span> <span class="n">fancyMessage</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">fancyMessage</span> <span class="k">instanceof</span> <span class="nc">SuperFancyMessage</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">handleSuperFancyMessage</span><span class="o">((</span><span class="nc">SuperFancyMessage</span><span class="o">)</span> <span class="n">fancyMessage</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">fancyMessage</span> <span class="k">instanceof</span> <span class="nc">OkOkFancyMessage</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">handleOkOkFancyMessage</span><span class="o">((</span><span class="nc">OkOkFancyMessage</span><span class="o">)</span> <span class="n">fancyMessage</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="c1">// handle other cases</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h2 id="how-do-we-apply-rate-limiting"> <a href="#how-do-we-apply-rate-limiting" class="anchor-heading" aria-labelledby="how-do-we-apply-rate-limiting"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How do we apply rate limiting?</h2>
<p>Rate limiting can be implemented using middleware. In the middleware, you can customize whether to allow or reject messages based on specific criteria.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">MyRateLimiter</span> <span class="kd">implements</span> <span class="nc">RateLimiterMiddleware</span> <span class="o">{</span>

  <span class="kd">final</span> <span class="nc">RateLimiter</span> <span class="n">rateLimiter</span><span class="o">;</span>

  <span class="nc">MyRateLimiter</span><span class="o">(</span><span class="nc">RateLimiter</span> <span class="n">rateLimiter</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">rateLimiter</span> <span class="o">=</span> <span class="n">rateLimiter</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isThrottled</span><span class="o">(</span><span class="nc">Job</span> <span class="n">job</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">RqueueMessage</span> <span class="n">rqueueMessage</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="na">getRqueueMessage</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">rqueueMessage</span><span class="o">.</span><span class="na">getQueueName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"rate-limited-queue"</span><span class="o">))</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">rateLimiter</span><span class="o">.</span><span class="na">tryAcquire</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="nc">Object</span> <span class="n">message</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="na">getMessage</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">message</span> <span class="k">instanceof</span> <span class="nc">RateLimitedMessage</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">rateLimiter</span><span class="o">.</span><span class="na">tryAcquire</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Using rate limiting middleware:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RqueueConfiguration</span> <span class="o">{</span>

  <span class="nd">@Bean</span>
  <span class="kd">public</span> <span class="nc">SimpleRqueueListenerContainerFactory</span> <span class="nf">simpleRqueueListenerContainerFactory</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">SimpleRqueueListenerContainerFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleRqueueListenerContainerFactory</span><span class="o">();</span>
    <span class="nc">RateLimiterMiddleware</span> <span class="n">limiterMiddleware</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MyRateLimiter</span><span class="o">();</span>
    <span class="n">factory</span><span class="o">.</span><span class="na">useMiddleware</span><span class="o">(</span><span class="n">limiterMiddleware</span><span class="o">);</span>
    <span class="c1">// add other middlewares here</span>
    <span class="k">return</span> <span class="n">factory</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h2 id="does-rqueue-support-generic-classes"> <a href="#does-rqueue-support-generic-classes" class="anchor-heading" aria-labelledby="does-rqueue-support-generic-classes"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Does Rqueue support generic classes?</h2>
<p>No, Rqueue does not support generic classes.</p>
<h2 id="why-are-messages-consumed-late-by-a-listener"> <a href="#why-are-messages-consumed-late-by-a-listener" class="anchor-heading" aria-labelledby="why-are-messages-consumed-late-by-a-listener"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why are messages consumed late by a listener?</h2>
<p>Messages should typically be consumed promptly by listeners. Delays may occur if there are more messages in the queue than available listeners, or due to high processing times. To minimize delays, consider increasing the concurrency of your queue.</p>
<p>For scheduled messages, you can monitor the queue details page and ensure the time left is always greater than <code class="language-plaintext highlighter-rouge">-1000 milliseconds</code>.</p>
<h2 id="how-can-we-retrieve-a-jobs-position-in-the-queue"> <a href="#how-can-we-retrieve-a-jobs-position-in-the-queue" class="anchor-heading" aria-labelledby="how-can-we-retrieve-a-jobs-position-in-the-queue"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How can we retrieve a job’s position in the queue?</h2>
<p>Determining a job’s exact position in the queue can be challenging due to parallel processing and Redis data structures. You can estimate the queue size by checking pending and scheduled message counts.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">TestJobPosition</span> <span class="o">{</span>

  <span class="nd">@Autowired</span>
  <span class="kd">private</span> <span class="nc">RqueueQueueMetrics</span> <span class="n">rqueueQueueMetrics</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getTestQueueSize</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">rqueueQueueMetrics</span><span class="o">.</span><span class="na">getPendingMessageCount</span><span class="o">(</span><span class="s">"test-queue"</span><span class="o">)</span> <span class="o">+</span>
        <span class="n">rqueueQueueMetrics</span><span class="o">.</span><span class="na">getScheduledMessageCount</span><span class="o">(</span><span class="s">"test-queue"</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h2 id="how-can-we-scale-rqueue-to-process-millions-of-messages-per-hour"> <a href="#how-can-we-scale-rqueue-to-process-millions-of-messages-per-hour" class="anchor-heading" aria-labelledby="how-can-we-scale-rqueue-to-process-millions-of-messages-per-hour"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How can we scale Rqueue to process millions of messages per hour?</h2>
<p>To scale Rqueue for high throughput:</p>
<ul>
<li>Use a minimal number of queues and utilize them efficiently.</li>
<li>Distribute queues across multiple machines.</li>
<li>Group queues using priority groups.</li>
<li>Increase batch sizes if threads are underutilized.</li>
<li>Disable unnecessary features like job persistence and immediate message deletion.</li>
</ul>
<p>For optimal performance, group queues based on message rates, business verticals, and message types.</p>
<h2 id="rqueue-is-using-a-significant-amount-of-redis-memory-how-can-this-be-managed"> <a href="#rqueue-is-using-a-significant-amount-of-redis-memory-how-can-this-be-managed" class="anchor-heading" aria-labelledby="rqueue-is-using-a-significant-amount-of-redis-memory-how-can-this-be-managed"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rqueue is using a significant amount of Redis memory. How can this be managed?</h2>
<p>Rqueue stores completed jobs and messages in Redis by default. To reduce Redis memory usage, disable job persistence and immediate message deletion:</p>
<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="py">rqueue.job.enabled</span><span class="p">=</span><span class="s">false</span>
<span class="py">rqueue.message.durability.in-terminal-state</span><span class="p">=</span><span class="s">0</span>
</code></pre></div></div>
<h2 id="how-can-we-consume-events-from-the-dead-letter-queue"> <a href="#how-can-we-consume-events-from-the-dead-letter-queue" class="anchor-heading" aria-labelledby="how-can-we-consume-events-from-the-dead-letter-queue"><svg viewbox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How can we consume events from the dead letter queue?</h2>
<p>To consume messages from the dead letter queue:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nd">@Component</span>
<span class="kd">class</span> <span class="nc">ReservationRequestMessageConsumer</span> <span class="o">{</span>

  <span class="nd">@RqueueListener</span><span class="o">(</span>
      <span class="n">value</span> <span class="o">=</span> <span class="s">"reservation.request.queue"</span><span class="o">,</span>
      <span class="n">deadLetterQueue</span> <span class="o">=</span> <span class="s">"reservation.request.dead.letter.queue.name"</span><span class="o">,</span>
      <span class="n">deadLetterQueueListenerEnabled</span> <span class="o">=</span> <span class="s">"true"</span><span class="o">,</span>
      <span class="n">numRetries</span> <span class="o">=</span> <span class="s">"3"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMessageReservationRequest</span><span class="o">(</span><span class="nc">ReservationRequest</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">// Handle messages from main queue</span>
  <span class="o">}</span>

  <span class="nd">@RqueueListener</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"reservation.request.dead.letter.queue"</span><span class="o">,</span> <span class="n">numRetries</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">)</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMessageReservationRequestDeadLetterQueue</span><span class="o">(</span>
      <span class="nc">ReservationRequest</span> <span class="n">request</span><span class="o">,</span>
      <span class="nd">@Header</span><span class="o">(</span><span class="nc">RqueueMessageHeaders</span><span class="o">.</span><span class="na">MESSAGE</span><span class="o">)</span> <span class="nc">RqueueMessage</span> <span class="n">rqueueMessage</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">// Handle messages from dead letter queue</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<hr>
<footer><p><a href="#top" id="back-to-top">Back to top</a></p>Copyright © 2019-2024 Sonu Kumar. Distributed by an <a href="https://github.com/sonus21/rqueue/tree/main/LICENSE">Apache 2.0 license.</a> Build on 2024-07-09 03:58<div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/sonus21/rqueue/tree/main/faq.md" id="edit-this-page">Edit this page on GitHub</a></p></div></footer>
</div></div>
<div class="search-overlay"></div>
</div>
<script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
</body>
</html>
